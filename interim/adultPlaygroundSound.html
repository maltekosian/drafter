<!DOCTYPE html >
<html>
 <head>
  <title> new document </title>
  <meta name="generator" content="editplus" />
  <meta name="author" content="" />
  <meta name="keywords" content="" />
  <meta name="description" content="" />
 </head>

 <body>
  <button onclick='playpause()'>play/pause</button><br>
<input id='inputDetu' value='100'>cent <button onclick='setDetune()'>set</button>
<br>
<select id='select' onchange='setType(this.value)'></select>
<br>
<input id='inputFreq' value='440'>hz <button onclick='setFrequency()'>set</button>
<script>
  var options = ['sine', 'square', 'sawtooth', 'triangle'];
  var select = document.getElementById('select');
  options.forEach(function(option, i) {
    select.add(new Option(option, option));
  });
  // Temporary work around until AudioContext is standardized 
  window.AudioContext = window.AudioContext || window.webkitAudioContext;
 
  var context = new AudioContext();
  var oscillator = context.createOscillator();
  oscillator.frequency.value = 440;

  var real = [0];
  var imaginary = [0]; 

  for (var i = 0; i < 8; i++) {
    real.push(Math.cos(i));
    imaginary.push(Math.random());
  }

  var periodicWave = context.createPeriodicWave(new Float32Array(real), new Float32Array(imaginary));
  oscillator.setPeriodicWave(periodicWave);

  oscillator.start(0);
  var connected = false;
  
  var playpause = function() {
    if (!connected) {

      oscillator.connect(context.destination);

    }
    else {
      oscillator.disconnect();
    }
    connected = !connected;
  };

  var setDetune = function(value) {
    var input = document.getElementById('inputDetu');
    oscillator.detune.value = +input.value;
  };

var setType = function(type) {
    oscillator.type = type;
  };
var setFrequency = function(value) {
    var input = document.getElementById('inputFreq');
    oscillator.frequency.value = input.value;
    //console.log(value);
  };
</script>
 </body>
</html>
