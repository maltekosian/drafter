<!doctype html>
<html>
 <head>
  <title> editor for text games </title>
  <meta name="generator" content="editplus">
  <meta name="author" content="">
  <meta name="keywords" content="">
  <meta name="description" content="">
<script type="text/javascript" src="js/base64.js"></script>
<script type="text/javascript" id="game_source">
/**
@class Note
@param _uid
@since 2014-05-17
*/
function Note(_uid) {
 /***/
 this.uid = _uid;
 /***/
 this.text = null;
 /***/
 this.title = null;
 /***/
 this.connections = [];
 /***/
 this.load = function(data) {
   console.log(data);
  this.uid = data['uid'];
  for (var i = 0; i < data['connections'].length;i++) {
   var connection = new Connection(data['connections'][i]['uid']);
   connection.load(data['connections'][i]);
   this.connections.push(connection);
  }
  this.text = data['text'];
  this.title = data['title'];
 };
};
/**
@class Connection
@param _uid
@since 2014-05-17
*/
function Connection(_uid) {
 /***/
 this.uid = _uid;
 /***/
 this.text = null;
 /***/
 this.to_uid = null;
 /***/
 this.from_uid = null;
 /***/
 this.load = function(data) {
  this.uid = data['uid'];
  this.text = data['text'];
  this.to_uid = data['to_uid'];
  this.from_uid = data['from_uid'];
 };
};
/**
@class MediaLanguage
@param _lan
@since 2014-05-18
*/
function MediaLanguage(_lan) {
 this.language = _lan;
 this.medias = [];
 /**
 @method load
 @param data
 @since 2014-05-29
 */
 this.load = function(data) {
  this.language = data['language'];
  this.medias = [];
  for (var i = 0; i < data['medias'].length; i++) {
   this.medias.push({ key:data['medias'][i]['key'], value:data['medias'][i]['value']});
  }
 };
 this.setMedia = function(_k, _v) {
  //console.log('setMedia'+_k);
  if (this.hasMedia(_k)) {
   this.getMedia(_k).value = Base64.encode(_v);
  } else {
   this.addMedia(_k, _v);
  }
 };
 this.getMedia = function(_k) {
  for (var i = 0; i < this.medias.length; i++) {
   if (this.medias[i].key == _k) {
    return this.medias[i];
   }
  }
  return null;
 };
 this.getMediaValue = function(_k) {
  for (var i = 0; i < this.medias.length; i++) {
   if (this.medias[i].key == _k) {
    //console.log('getMedia->'+Base64.decode(this.medias[i].value));
    return Base64.decode(this.medias[i].value);
   }
  }
  return null;
 };
 this.hasMedia = function(_k, _v) {
  for (var i = 0; i < this.medias.length; i++) {
   if (this.medias[i].key == _k) {
    return true;
   }
  }
  return false;
 };
 this.deleteMedia = function(_k, _v) {
  for (var i = 0; i < this.medias.length; i++) {
   if (this.medias[i].key == _k) {
    return this.medias.splice(i, 1);
   }
  }
 };
 this.addMedia = function(_k, _v) {
  this.medias.push(this.createMedia(_k, _v));
 };
 this.createMedia = function(_k, _v) {
  return { key : _k, value : Base64.encode(_v) };
 };
};
/**
The Game class
@class Game
@since 2014-05-17
*/
function Game() {
 /**
 the major data type array
 @parameter notes
 @since 2014-05-17
 */
 this.notes = [];
 /**
 @parameter startNote
 @since 2014-05-29
 */
 this.startNote = null;
 /**
 @method load
 @since 2014-05-17
 */
 this.load = function(data) {
  if (data == null) {
    data = window.localStorage.getItem('game_data');
    data = JSON.parse(data);
    if (data == null) {
     //avoid a cannot read property exception
     //
     return;
    }
  }
  console.log('');
  console.log(data);
  this.mediamanager.load(data['mediamanager']);
  this.startNote = data['startNote'];
  this.notes = [];
  for (var i = 0; i < data['notes'].length;i++) {
   var note = new Note(data['notes'][i]['uid']);
   note.load(data['notes'][i]);
   this.notes.push(note);
  }  
 };
 /**
 @method save
 @since 2014-05-17
 */
 this.save = function() {
  var data = JSON.stringify(game);
  console.log('save data:');
  console.log(data);
  console.log(':save data');
  window.localStorage.setItem('game_data', data);
 };
 /**
 @class mediamanager
 @since 2014-05-18
 */
 this.mediamanager = {
  defaultLanguage : 'en',
  currentLanguage : 'en',
  languages : [],
  mediaLanguages : [],
  setCurrentLanguage : function(_lan) {
   this.currentLanguage = _lan;
   if (!this.hasLanguage(_lan)) {
    this.addLanguage(_lan);
   }
  },
  addLanguage : function(_lan) {
   this.mediaLanguages.push( new MediaLanguage(_lan) );
   this.languages.push(_lan);
  },
  hasLanguage : function(_lan) {
   for (var i = 0; i < this.languages.length; i++) {
    if (this.languages[i] == _lan) {
     return true;
    }
   }
   return false;
  },
  getCurrentLanguage : function() {
   for (var i = 0; i < this.mediaLanguages.length; i++) {
    if (this.mediaLanguages[i].language == this.currentLanguage) {
     return this.mediaLanguages[i];
    }
   }
   this.currentLanguage = this.defaultLanguage;
   var language = new MediaLanguage(this.currentLanguage);
   this.mediaLanguages.push( language );
   this.languages.push(this.currentLanguage);
   return language;
  },
  setMedia : function(_k, _v) {
   //type64=true|false would regulate de/encoding or not
   for (var i = 0; i < this.mediaLanguages.length; i++) {
    this.mediaLanguages[i].setMedia(_k, _v);
   }
  },
  deleteMedia : function(_k) {
   for (var i = 0; i < this.mediaLanguages.length; i++) {
    this.mediaLanguages[i].deleteMedia(_k);
   }
  },
  getMedia : function(_k) {
   return this.getCurrentLanguage().getMedia(_k);
  },
  getMediaValue : function(_k) {
   return this.getCurrentLanguage().getMediaValue(_k);
  },
  /**
  @method load
  @param data
  @since 2014-05-29
  */
  load : function(data) {
   this.defaultLanguage = 'en',
   this.currentLanguage = data['currentLanguage'];
   this.languages = data['languages'];
   this.mediaLanguages = [];
   for (var i = 0; i < data['mediaLanguages'].length; i++) {
    var lan = new MediaLanguage(data['mediaLanguages'][i]['uid']);
    lan.load(data['mediaLanguages'][i]);
    this.mediaLanguages.push(lan);
   }
  }
 }
}
/**
@property game
@since 2014-05-28
*/
var game = new Game();

</script>
 <script type="text/javascript" id="editor_source">
  window.URL = window.URL || window.webkitURL || null;
  window.Blob = window.WebKitBlob || window.MozBlob || window.MSBlob || window.Blob || null;
  window.BlobBuilder = window.WebKitBlobBuilder || window.MozBlobBuilder || window.MSBlobBuilder || window.BlobBuilder;

  (
    function(_win) {
      var editor = {};
      /***/
      editor.func = null;
      /***/
      editor.width = 0;
      /***/
      editor.height = 0;
      /***/
      editor.game = new Game();
      /**
      You should store a game data before you test the code whit the game
      @method saveCodeAndGame
      @since 2014-05-17
      */
      editor.saveCodeAndGame = function() {
        var code = getElement('texteditor').value;
        _win.localStorage.setItem('texteditor-code', code);
        var data = JSON.stringify(editor.game);
        //console.log(data);
        _win.localStorage.setItem('game_data', data);
      };
      /**
      @method loadCodeAndGame
      @since 2014-05-17
      */
      editor.loadCodeAndGame = function() {
        var code = _win.localStorage.getItem('texteditor-code');
        getElement('texteditor').value = code;
        var data = _win.localStorage.getItem('game_data');
        //console.log(data);
        editor.game = new Game();
        editor.game.mediamanager.addLanguage(editor.game.mediamanager.defaultLanguage);
        editor.game.load(JSON.parse(data));
        getElement('noteeditor').innerHTML = '';
        getElement('notelist').innerHTML = '';
        for (var i = 0; i < editor.game.notes.length; i++) {
          editor.addNote(editor.game.notes[i]);
        }
        for (var i = 0; i < editor.game.notes.length; i++) {
          var cons = editor.game.notes[i].connections;
          for (var j = 0; j < cons.length; j++) {
            editor.addArrowLine(cons[j].from_uid, cons[j].to_uid);
          }
        }
      };
      /**
      @method testGame
      @since 2014-05-17
      */
      editor.testGame = function() {
        var code = _win.localStorage.getItem('texteditor-code');
        //getElement('texteditor').value = code;
        //perform the code
        try {
          editor.func = new Function('window,document', code);
          editor.func(window, document);
        } catch(e) {
          console.log(e);
        }
      };
      /**
      @method stopTest
      @since 2014-05-17
      */
      editor.stopTest = function() {
        if (editor.func != null) {
          editor.func = null;
          document.body.removeChild(document.body.childNodes[document.body.childNodes.length-1]);
        }
      };
      /**
      @method toggleEditor
      @since 2014-05-17
      */
      editor.toggleEditor = function() {
        if (getElement('noteeditor_box').style.display != 'block') {
          getElement('noteeditor_box').style.display = 'block';
          getElement('texteditor').style.display = 'none';
        } else {
          getElement('noteeditor_box').style.display = 'none';
          getElement('texteditor').style.display = 'block';
        }
      };
      /**
      @method resize
      @since 2014-05-17
      */
      editor.resize = function() {
        editor.width = window.innerWidth;
        editor.height = window.innerHeight;
      }
      /**
      @method init
      @since 2014-05-28
      */
      editor.init = function() {
        editor.resize();
        var ele = getElement('editor');
        ele.style.height = (editor.height - 5) + 'px';
        ele.style.width = (editor.width - 5) + 'px';
        var game_source = getElement('game_source').innerHTML;
        getElement('texteditor').value = getElement('texteditor').value + game_source;
        editor.game = new Game();
        editor.game.mediamanager.addLanguage(editor.game.mediamanager.defaultLanguage);
        ele = getElement('noteeditor').addEventListener('mousedown', editor.mousedown, false);
        //experimental from here

      };
      /**
      @parameter uidcounter
      @since 2014-05-18
      */
      editor.uidcounter = [];
      /**
      @method createUid
      @since 2014-05-18
      */
      editor.createUid = function() {
        var abc = 'abcdefghijklmnopqrstuvwxyz1234567890ABCDEFGHIJKLMNOPQRSTUVWXYZ';
        var uid = '';
        while (uid.length < 5 || editor.hasUid(uid)) {
          for (var i = 0; i < 5; i++) {
            uid = uid + abc.substr(Math.floor(Math.random()*abc.length), 1);
          }
          if (editor.hasUid(uid)) {
            uid = '';
          }
        }
        editor.uidcounter.push(uid);
        return uid;
      }
      /**
      @method hasUid
      @since 2014-05-18
      @param _uid
      */
      editor.hasUid = function(_uid) {
        for (var i = 0; i < editor.uidcounter.length; i++) {
          if (editor.uidcounter[i] == _uid) {
            return true;
          }
        }
        return false;
      }
      /**
      @method deleteUid
      @since 2014-05-18
      */
      editor.deleteUid = function(_uid) {
        for (var i = 0; i < editor.uidcounter.length; i++) {
          if (editor.uidcounter[i] == _uid) {
            editor.uidcounter.splice(i, 1);
          }
        }
      }
      editor.noteStartX = 5;
      editor.noteStartY = 5;
      /**
      @method addNote
      @since 2014-05-18
      */
      editor.addNote = function( note ) {
        if (note == null) {
          note = new Note(editor.createUid());
          editor.game.notes.push(note);
          console.log(note);
        }
        //add the visual note container to the noteeditor
        var ele = getElement('noteeditor');
        var child = createElement('div');
        child.className = 'note';
        child.setAttribute('id','note_'+note.uid);
        ele.appendChild(child);
        editor.noteStartX += 160;
        editor.noteStartY += 110;
        if (editor.noteStartX + 150 > editor.width) {
          editor.noteStartX = editor.noteStartX + 150 - editor.width;
        }
        if (editor.noteStartY + 110 > editor.height * 0.9) {
          editor.noteStartY = editor.noteStartY + 110 - (editor.height * 0.9);
        }
        child.style.left = editor.noteStartX+'px';
        child.style.top = editor.noteStartY+'px';
        var child2 = createElement('div');
        child2.setAttribute('id','note_'+note.uid+'_bar');
        child2.className = 'note_bar';
        child.appendChild(child2);
        var child3 = createElement('span');
        child3.setAttribute('id','note_'+note.uid+'_uid');
        child3.className ='note_uid';
        child3.appendChild(document.createTextNode(note.uid));
        child2.appendChild(child3);
        //
        child2 = createElement('div');
        child2.setAttribute('id','con_menu_'+note.uid);
        child2.className = 'connection';
        child2.appendChild(document.createTextNode('connects: '));
        child3 = createElement('span');
        child3.setAttribute('id','con_amount_'+note.uid);
        child3.appendChild(document.createTextNode(' '+note.connections.length));
        child2.appendChild(child3);
        if (note.uid == editor.game.startNote) {
          child3 = createElement('span');
          child3.className = 'con_start';
          child3.setAttribute('id', 'con_start_'+note.uid);
          child3.appendChild(createTextNode('start'));
          child2.appendChild(child3);
        }
        child.appendChild(child2);
        //
        child2 = createElement('input');
        child2.setAttribute('type','text');
        child2.setAttribute('id','note_'+note.uid+'_title');
        child2.className ='note_title';
        child2.setAttribute('placeholder','note title');
        if (note.title != null) {
          child2.value = editor.game.mediamanager.getMediaValue(note.title);
        }        
        child.appendChild(child2);
        child2 = createElement('textarea');
        child2.setAttribute('id','note_'+note.uid+'_text');
        child2.className = 'note_text';
        child2.setAttribute('placeholder','note text');
        if (note.text != null) {
          child2.value = editor.game.mediamanager.getMediaValue(note.text);
        } 
        child.appendChild(child2);
        child2 = createElement('div');
        child2.setAttribute('id','note_'+note.uid+'_overlay');
        child2.className = 'note_overlay';
        child.appendChild(child2);
        //THE MENU -> make this a editor method
        //add to notelist too    
        child2 = createElement('div');
        child2.appendChild(document.createTextNode('*'));
        child2.className = 'note_menu_button';
        //
        child3 = createElement('div');
        child3.className = 'note_menu';
          child4 = createElement('div');
          child4.className = 'menu_element';
          child4.setAttribute('onclick','editor.editNote(\''+note.uid+'\');');
          child4.appendChild(document.createTextNode('edit note'));
          child3.appendChild(child4);
          //
          child4 = createElement('div');
          child4.className = 'menu_element';
          child4.setAttribute('onclick','editor.deleteNote(\''+note.uid+'\');');
          child4.appendChild(document.createTextNode('delete note'));
          child3.appendChild(child4);
          //
          child4 = createElement('div');
          child4.className = 'menu_element';
          child4.setAttribute('onclick','editor.setStartNote(\''+note.uid+'\');');
          child4.appendChild(document.createTextNode('set start note'));
          child3.appendChild(child4);
          //
          child4 = createElement('div');
          child4.className = 'menu_element';
          child4.setAttribute('onclick','editor.openAddConnectionBox(\''+note.uid+'\');');
          child4.appendChild(document.createTextNode('add connection'));
          child3.appendChild(child4);
          //
          child4 = createElement('div');
          child4.className = 'menu_element';
          child4.setAttribute('data-from-id',''+note.uid);
          child4.setAttribute('onclick','editor.openDeleteConnectionBox(\''+note.uid+'\');');
          child4.appendChild(document.createTextNode('delete connection'));
          child3.appendChild(child4);
        child2.appendChild(child3);
        //THE MENU END
        child.appendChild(child2);

        ele = getElement('notelist');
        child = createElement('div');
        child.className = 'notelistBox';
        ele.appendChild(child);
        child2 = createElement('span');
        child2.appendChild(document.createTextNode(note.uid));
        child.appendChild(child2);
        child.appendChild(createElement('br'));
        child2 = createElement('span');
        if (note.title != null) {
          child2.appendChild(document.createTextNode(editor.game.mediamanager.getMediaValue(note.title) ) );
        }      
        child2.setAttribute('id', 'notelistElement_'+note.uid);
        child.setAttribute('id', 'notelistBox_'+note.uid);
        child.appendChild(child2);
        child.appendChild(createElement('br'));
      }
      /**
      @method setStartNote
      @since 2014-05-29
      @param _uid
      */
      editor.setStartNote = function(_uid) {
        console.log('setStartNote = '+_uid);
        if (editor.game.startNote != null) {
          //remove startNote visualation
          getElement('con_menu_'+editor.game.startNote).removeChild(
                      getElement('con_start_'+editor.game.startNote) );
        }
        editor.game.startNote = _uid;
        //visualize startNote
        var ele = getElement('con_menu_'+_uid);
        console.log(ele);
        console.log('setStartNote = con_menu_'+_uid);
        var child = createElement('span');
        child.className = 'con_start';
        child.setAttribute('id', 'con_start_'+_uid);
        child.appendChild(createTextNode('start'));
        ele.appendChild(child);
      }
      /**
      @method deleteNote
      @since 2014-05-18
      @param _uid
      */
      editor.deleteNote = function(_uid) {
        for (var i = 0; i < editor.game.notes.length; i++) {
          if (editor.game.notes[i].uid == _uid) {
            var note = editor.game.notes[i];

            getElement('noteeditor').removeChild(getElement('note_'+note.uid));

            getElement('notelist').removeChild(getElement('notelistBox_'+note.uid));

            var cons = note.connections;
            for (var k = 0; k < cons.length; k++) {
              var tcons = null;
              if (cons[k].to_uid == note.uid) {
                tcons = editor.getNote(cons[k].from_uid).connections;
              } else {
                tcons = editor.getNote(cons[k].to_uid).connections;
              }
              for (var j = 0; j < tcons.length; j++) {
                getElement('noteeditor').removeChild(getElement('arrow_'+tcons[j].from_uid+'_'+tcons[j].to_uid));
                tcons.splice(j, 1);
              }
            }
            //delete the uid from the uid couter
            //delete the links' uids
            //delete the medias from the mediamanager
            editor.game.notes.splice(i, 1);
          }
        }
      }
      /**
      @method getNote
      @since 2014-05-22
      @param _uid
      */
      editor.getNote = function(_uid) {
        for (var i = 0; i < editor.game.notes.length; i++) {
          if (editor.game.notes[i].uid == _uid) {
            return editor.game.notes[i];
          }
        }
        return null;
      };
      /**
      @method editNote
      @since 2014-05-26
      @param _id
      */
      editor.editNote = function(_id) {
        console.log(_id);
        var c_note = editor.getNote(_id);

        var child = createElement('div');
        var child2 = createElement('span');
        child.appendChild(child2);
        child2.appendChild(document.createTextNode(c_note.uid));
        child.appendChild(createElement('br'));
        child.appendChild(document.createTextNode('title: '));
        child2 = createElement('input');
        child2.setAttribute('id', 'input_note_title');
        child2.setAttribute('name', 'input_note_title');
        if (c_note.title != null)
          child2.value = editor.game.mediamanager.getMediaValue(c_note.title);
        child.appendChild(child2);
        child.appendChild(createElement('br'));
        child.appendChild(document.createTextNode('text: '));
        child2 = createElement('textarea');
        child2.setAttribute('id', 'input_note_text');
        child2.setAttribute('name', 'input_note_text');
        if (c_note.text != null)
          child2.value = editor.game.mediamanager.getMediaValue(c_note.text);
        child.appendChild(child2);
        child.appendChild(createElement('br'));
        child2 = createElement('button');
        child2.setAttribute('onclick', 'editor.addTextAndTitleToNote(\''+c_note.uid+'\');');
        child2.appendChild(document.createTextNode('done'));
        child.appendChild(child2);
        child2 = createElement('button');
        child2.setAttribute('onclick', 'editor.addTextAndTitleToNote(null);');
        child2.appendChild(document.createTextNode('X'));
        child2.className = 'closeBoxButton';
        child.appendChild(child2);
        child.setAttribute('id', 'note_input_box');
        getElement('editor').appendChild(child);//from noteeditor to editor
      }
      /**
      @method addTextAndTitleToNote
      @since 2014-05-26
      @param _id the note uid
      */
      editor.addTextAndTitleToNote = function(_id) {
        console.log('539 -> '+_id);
        if (_id == null) {
          getElement('editor').removeChild(getElement('note_input_box'));
          return;
        }
        var c_note = editor.getNote(_id);
        if (c_note.text == null) {
          c_note.text = editor.createUid();
        }
        editor.game.mediamanager.setMedia(c_note.text, getElement('input_note_text').value);
        if (c_note.title == null) {
          c_note.title = editor.createUid();
        }
        editor.game.mediamanager.setMedia(c_note.title, getElement('input_note_title').value);
        console.log('->'+editor.game.mediamanager.getMediaValue(c_note.title) );
        getElement('note_'+_id+'_title').value = editor.game.mediamanager.getMediaValue(c_note.title);
        getElement('notelistElement_'+_id).innerHTML = '';
        getElement('notelistElement_'+_id).appendChild(document.createTextNode(
                                                       editor.game.mediamanager.getMediaValue(c_note.title) ) );
        getElement('note_'+_id+'_text').value = editor.game.mediamanager.getMediaValue(c_note.text);

        getElement('editor').removeChild(getElement('note_input_box'));
      }

      /**
      @method openAddConnectionBox
      @param _id
      @since 2014-05-22
      */
      editor.openAddConnectionBox = function (_id) {
	      //        alert('editor.openAddConnectionBox');
        var child = createElement('div');
        child.setAttribute('id','addConnectionBox');
	      child.className = 'connectionBox';
        child.appendChild(document.createTextNode('from: '));
        var child2 = createElement('span');
        child2.setAttribute('id','boxFrom');
        child.appendChild(child2);
        child.appendChild(createElement('br'));
        child.appendChild(document.createTextNode('text: '));
        child2 = createElement('input');
        child2.style.width = "200px";
        child2.setAttribute('id','boxText');
        child2.setAttribute('name','boxText');
        child2.setAttribute('type','text');
        child2.setAttribute('placeholder','edit message here');
        child.appendChild(child2);
        child.appendChild(createElement('br'));
        var select = createElement('select');
        select.setAttribute('id','boxTo');
        select.setAttribute('name','boxTo');
        child.appendChild(select);
        child2 = createElement('button');
        child2.setAttribute('id','addConnectionBoxButton');
        child2.setAttribute('data-from-id',''+_id);
        child2.setAttribute('onclick','editor.closeAddConnectionBox(this.getAttribute(\'data-from-id\'));');
        child2.appendChild(document.createTextNode('add'));
        child.appendChild(child2);
        child2 = createElement('button');
        child2.className = 'closeBoxButton';
        child2.setAttribute('onclick','editor.closeAddConnectionBox(this.getAttribute(null));');
        child2.appendChild(document.createTextNode('X'));
        child.appendChild(child2);

        getElement('editor').appendChild(child);
	      getElement('addConnectionBox').style.display= 'block';
	      getElement('boxFrom').innerHTML = _id;

	      var select = getElement('boxTo');
	      select.innerHTML = '';
	      var child = document.createElement('option');
	      child.setAttribute('value', '---');
	      select.appendChild(child);
	      for (var i = 0; i < editor.game.notes.length; i++) {
	        child = document.createElement('option');
	        child.setAttribute('value', ''+editor.game.notes[i].uid);
          child.appendChild(document.createTextNode(editor.game.notes[i].uid));
          select.appendChild(child);
        }
      };
      /**
      @method closeAddConnectionBox
      @param _id
      @since 2014-05-22
      */
      editor.closeAddConnectionBox = function(_id) {
        if (_id == null) {
          getElement('editor').removeChild(getElement('addConnectionBox'));
          return;
        }
        //alert('editor.closeAddConnectionBox');
	      var c_note = editor.getNote(_id); //the current note
        //console.log('call -> '+_id);alert('call -> '+_id);
        var value = getElement('boxTo').value;
        console.log('call ->'+value);
        var con = new Connection(editor.createUid());
        con.from_uid = _id;
        con.to_uid = value;
        if (con.text == null) {
          con.text = editor.createUid();
        }
        editor.game.mediamanager.setMedia(con.text, getElement('boxText').value);
        c_note.connections.push( con );
        editor.getNote(value).connections.push( con );
        getElement('con_amount_'+_id).innerHTML = '';
        getElement('con_amount_'+_id).appendChild(
            document.createTextNode(' '+c_note.connections.length));
        getElement('editor').removeChild(getElement('addConnectionBox'));
        editor.addArrowLine(_id, value);
      };
      /**
      @method openDeleteConnectionBox
      @param _id
      @since 2014-05-23
      */
      editor.openDeleteConnectionBox = function (_id) {
        var child = createElement('div');
        child.setAttribute('id', 'deleteConnectionBox');
        child.className = 'connectionBox';
        getElement('editor').appendChild(child);
        child.appendChild(document.createTextNode('from: '+_id));
        child.appendChild(createElement('br'));

        var select = createElement('select');
        select.setAttribute('id','boxTo');
        select.setAttribute('name','boxTo');
        select.innerHTML = '';
	      var child2 = document.createElement('option');
	      child2.setAttribute('value', '---');
	      select.appendChild(child2);

        var cons = editor.getNote(_id).connections;

	      for (var i = 0; i < cons.length; i++) {
	        child2 = document.createElement('option');
	        child2.setAttribute('value', ''+cons[i].uid);
          child2.appendChild(document.createTextNode(cons[i].from_uid+' -> '+cons[i].to_uid));
          select.appendChild(child2);
        }
        child.appendChild(select);

        child2 = createElement('button');
        child2.setAttribute('id','deleteConnectionBoxButton');
        child2.setAttribute('data-from-id',''+_id);
        child2.setAttribute('onclick','editor.closeDeleteConnectionBox(this.getAttribute(\'data-from-id\'));');
        child2.appendChild(document.createTextNode('delete'));
        child.appendChild(child2);
        child2 = createElement('button');
        child2.className = 'closeBoxButton';
        child2.setAttribute('onclick','editor.closeDeleteConnectionBox(this.getAttribute(null));');
        child2.appendChild(document.createTextNode('X'));
        child.appendChild(child2);
	    };
      /**
      @method closeDeleteConnectionBox
      @param _id
      @since 2014-05-23
      */
      editor.closeDeleteConnectionBox = function (_id) {
        if (_id == null) {
          getElement('editor').removeChild(getElement('deleteConnectionBox'));
          return;
        }
        var c_note = editor.getNote(_id);
        var cons = c_note.connections;
        var value = getElement('boxTo').value;
        for (var i = 0; i < cons.length; i++) {
          if (cons[i].uid == value) {
            var tcons = null;
            if (cons[i].to_uid == c_note.uid) {
              tcons = editor.getNote(cons[i].from_uid).connections;
            } else {
              tcons = editor.getNote(cons[i].to_uid).connections;
            }
            for (var j = 0; j < tcons.length; j++) {
              if (tcons[j].uid == value) {
                tcons.splice(j, 1);
              }
            }
            getElement('noteeditor').removeChild(getElement('arrow_'+cons[i].from_uid+'_'+cons[i].to_uid));
            cons.splice(i, 1);
          }
        }
        try {
          getElement('editor').removeChild(getElement('deleteConnectionBox'));
        }
        catch (e) {
        }
	    };
      /**
      @method addArrowLine
      @param from_uid
      @param to_uid
      @since 2014-05-22
      */
      editor.addArrowLine = function(from_uid, to_uid) {
        var c_ele = getElement('note_'+from_uid);
        var cx = c_ele.offsetLeft + c_ele.clientWidth;
        var cy = c_ele.offsetTop + c_ele.clientHeight;
        console.log(c_ele);
        var ele = getElement('note_'+to_uid);
        var x = ele.offsetLeft;
        var y = ele.offsetTop;
        var dy = y - cy;
        var dx = x - cx;
        var theta = Math.atan2(dy, dx);
        theta *= 180/Math.PI;
        var c = Math.abs(Math.sqrt(Math.pow(x-cx,2)+ Math.pow(y-cy,2)) );
        if (getElement('arrow_'+from_uid+'_'+to_uid) != null) {
          editor.updateArrowLine(from_uid, to_uid);
          return;
        }
        var arrow = createElement('div');
        arrow.className = 'arrow';
        arrow.setAttribute('id','arrow_'+from_uid+'_'+to_uid);
        arrow.style.position = 'absolute';
        arrow.style.top = cy+'px';
        arrow.style.left = cx+'px';
        getElement('noteeditor').appendChild(arrow);
        var arrow_png = createElement('img');
        var arrow_line = createElement('img');
        arrow.appendChild(arrow_line);
        arrow.appendChild(arrow_png);
        arrow_line.setAttribute('id','arrow_line_'+from_uid+'_'+to_uid);
        arrow_line.style.position = 'absolute';
        arrow_line.style.width = c+'px';
        arrow_line.style.top = '0px';
        arrow_line.style.height = '1px';
        arrow_line.src = 'img/line.png';
        arrow_png.setAttribute('id','arrow_png_'+from_uid+'_'+to_uid);
        arrow_png.style.position = 'absolute';
        arrow_png.style.left = (c-10)+'px';
        arrow_png.style.top = '-5px';
        arrow_png.src = 'img/arrow.png';

        arrow.style.transform = 'rotate('+theta+'deg)';
        arrow.style.msTransform = 'rotate('+theta+'deg)';
        arrow.style.webkitTransform = 'rotate('+theta+'deg)';
      };
      /**
      @method updateArrowLine
      @param from_uid
      @param to_uid
      @since 2014-05-22
      */
      editor.updateArrowLine = function(from_uid, to_uid) {
        var c_ele = getElement('note_'+from_uid);
        var cx = c_ele.offsetLeft + c_ele.clientWidth;
        var cy = c_ele.offsetTop + c_ele.clientHeight;
        console.log(c_ele);
        var ele = getElement('note_'+to_uid);
        var x = ele.offsetLeft;
        var y = ele.offsetTop;
        var dy = y - cy;
        var dx = x - cx;
        var theta = Math.atan2(dy, dx);
        theta *= 180/Math.PI;
        var c = Math.abs(Math.sqrt(Math.pow(x-cx,2)+ Math.pow(y-cy,2)) );

        var arrow = getElement('arrow_'+from_uid+'_'+to_uid);
        arrow.style.top = cy+'px';
        arrow.style.left = cx+'px';
        arrow.style.transform = 'rotate('+theta+'deg)';
        arrow.style.msTransform = 'rotate('+theta+'deg)';
        arrow.style.webkitTransform = 'rotate('+theta+'deg)';
        var arrow_line = getElement('arrow_line_'+from_uid+'_'+to_uid);
        var arrow_png = getElement('arrow_png_'+from_uid+'_'+to_uid);
        arrow_line.style.width = c+'px';
        arrow_line.style.heigt = '1px';
        arrow_png.style.left = (c-10)+'px';
        arrow_png.style.maxWidth = '10px';
        arrow_png.style.maxHeight = '11px';

      };

      /*
      @method buildExportBlobUrl

      @param data,
      @param name
      @param fileEnding

      @return element
      */
      editor.buildExportBlobUrl = function(data, name, fileEnding) {
        var type = {type: 'text/plain'};
        var bb = null;
        if (window.Blob == null) {
          console.log('no blob');
          return;
        }
        try {
          bb = new Blob([data], type);
        } catch (e) {
          bb = new BlobBuilder();
          bb.append(data);
          bb = bb.getBlob("text/plain");
        };

        var element = document.createElement('a');
        if (window.navigator.msSaveBlob) {
          element = window.navigator.msSaveBlob(bb, name+'.'+fileEnding);
        } else {
          element.href = fileEnding == 'json' ? window.URL.createObjectURL( bb ) : data;
          element.appendChild(document.createTextNode( name ));
          element.className = 'exportA';
          element.setAttribute('download', name+'.'+fileEnding);
          element.setAttribute('title', name+'.'+fileEnding);
        }
        return element;
      }
      /**
      @method exportEditor
      @since 2014-05-27
      */
      editor.exportEditor = function() {
        var ele = document.body;
        var child = createElement('div');
        var child2 = createElement('div');
        child2.appendChild(document.createTextNode(' download editor.json: '));
        child.appendChild(child2);
        editor.code = getElement('texteditor').value;
        editor.noteeditor_box = null;
        editor.noteeditor = null;
        var data = JSON.stringify(editor);//encodeURI(JSON.stringify(editor));//store same function like export here
        child2 = editor.buildExportBlobUrl( data, 'editor', 'json'); //
		    child.appendChild(child2);
        child.className = 'eximport';
        child.setAttribute('id','eximport');
        ele.appendChild(child);
        child2 = createElement('button');
        child2.className = 'closeBoxButton';
        child2.setAttribute('onclick','document.body.removeChild(getElement(\'eximport\'))');
        child2.appendChild(document.createTextNode('X'));
        child.appendChild(child2);
      };
      /**
      @method importEditor
      @since 2014-05-27
      */
      editor.importEditor = function(eve) {
        if (eve == null) {
          //alert('create upload form here');
          var ele = document.body;
          var child = createElement('div');
          child.className = 'eximport';
          child.setAttribute('id','eximport');
          child2 = createElement('button');
          child2.className = 'closeBoxButton';
          child2.setAttribute('onclick','document.body.removeChild(getElement(\'eximport\'))');
          child2.appendChild(document.createTextNode('X'));
          child.appendChild(child2);
          child.appendChild(document.createTextNode('upload your editor.json file:'));
          child.appendChild(createElement('br'));
          child2 = createElement('input');
          child2.setAttribute('type','file');
          child2.setAttribute('name','files');
          child2.setAttribute('id','files');
          child2.addEventListener('change', editor.importEditor, true);
          child.appendChild(child2);
          ele.appendChild(child);
          return;
        }
        var files = eve.target.files; // FileList object
        for (var i = 0; i < 1; i++) {
          var f = files[i];
          var reader = new FileReader();
          reader.onload = (function(theFile) {
            return function(e) {
              //console.log('handleJsonImport->'+theFile.name);
              console.log(e.target.result);
              editor.load(e.target.result);
              console.log(theFile.name);
              document.body.removeChild(getElement('eximport'));
            };
          })(f);
          /*if (i == files.length - 1)
          {
            reader.onloadend = importProjectJsons;
          }*/
          reader.readAsText(f, 'UTF-8');//readAsDataURL(f);//, 'UTF-8');
        }
      };
      /**
      @method buildGame
      @since 2014-05-27
      */
      editor.buildGame = function() {
        var ele = document.body;
        var child = createElement('div');
        var child2 = createElement('div');
        child2.appendChild(document.createTextNode(' download myDrafterGame.html: '));
        child.appendChild(child2);
        editor.code = getElement('texteditor').value;
        editor.noteeditor_box = null;
        editor.noteeditor = null;
        var data = JSON.stringify(editor);//encodeURI(JSON.stringify(editor));//store same function like export here
        child2 = editor.buildExportBlobUrl( data, 'myDrafterGame', 'html'); //
		    child.appendChild(child2);
        child.className = 'eximport';
        child.setAttribute('id','eximport');
        ele.appendChild(child);
        child2 = createElement('button');
        child2.className = 'closeBoxButton';
        child2.setAttribute('onclick','document.body.removeChild(getElement(\'eximport\'))');
        child2.appendChild(document.createTextNode('X'));
        child.appendChild(child2);
      };
      /**
      @method load
      @since 2014-05-28
      @param result
      */
      editor.load = function(result) {
        var json = JSON.parse(result);
        console.log(json);
        editor.game = new Game();
        editor.game.mediamanager.addLanguage(editor.game.mediamanager.defaultLanguage);
        editor.game.load(json['game']);
        //editor.func = json['func'];
        editor.uidcounter = json['uidcounter'];
        //noteStartX,noteStartY,ox,oy,width,height,pressed
        getElement('noteeditor').innerHTML = '';
        getElement('notelist').innerHTML = '';
        for (var i = 0; i < editor.game.notes.length; i++) {
          editor.addNote(editor.game.notes[i]);
        }
        getElement('noteeditor_box').style.display = 'block';
        for (var i = 0; i < editor.game.notes.length; i++) {
          var cons = editor.game.notes[i].connections;
          console.log(cons);
          for (var j = 0; j < cons.length; j++) {
            editor.addArrowLine(cons[j].from_uid, cons[j].to_uid);
            //editor.updateArrowLine(cons[j].from_uid, cons[j].to_uid);
          }
        }
      }
      /***/
      editor.pressed = false;
      /***/
      editor.ox = 0;
      /***/
      editor.oy = 0;
      /**
      attach to 'noteeditor' element
      if uid begins with note it is a note
      no loop is needed
      @method mousedown
      @param eve
      @since 2014-05-18
      */
      editor.mousedown = function(eve) {
        if (!editor.pressed) {
          editor.noteeditor_box = getElement('noteeditor_box');
          editor.noteeditor = getElement('noteeditor');
          var ele = eve.target;
          var splits = ele.id.split('_');
          var uid = splits[0]+'_'+splits[1];
          ele = getElement(uid);
          if (ele == null) {
            //do not know, what todo here right now
          } else {
            ele.addEventListener('mousemove', editor.mousemove, false);
            ele.addEventListener('mouseup', editor.mouseup, false);
            ele.addEventListener('mouseout', editor.mouseout, false);
            editor.ox = eve.pageX;// - editor.noteeditor_box.scrollLeft;
            editor.oy = eve.pageY;// - editor.noteeditor_box.scrollTop;
            console.log(ele.id+':'+eve.pageX+','+eve.pageY);
            editor.pressed = true;
            //noteeditor.style.width = editor.ox + 'px';
            //noteeditor.style.height = editor.oy + 'px';
          }
        }
      };
      /**
      @method mousemove
      @param eve
      @since 2014-05-18
      */
      editor.mousemove = function(eve) {
        if (editor.pressed) {
          var ele = eve.target;
          var splits = ele.id.split('_');
          var uid = splits[1];
          ele = getElement('note_'+uid);
          var cons = editor.getNote(uid).connections;
          var x = ele.offsetLeft + eve.pageX - editor.ox;
          var y = ele.offsetTop + eve.pageY - editor.oy;
          ele.style.top = y + 'px';
          ele.style.left = x + 'px';
          //console.log(ele.id+':'+eve.pageX+','+eve.pageY+','+ele.offsetLeft+','+ele.offsetTop);
          for (var i = 0; i < cons.length; i++) {
            editor.updateArrowLine(cons[i].from_uid,cons[i].to_uid);//from to
          }
          editor.ox = eve.pageX;
          editor.oy = eve.pageY;
        }
      };
      /**
      @method mouseup
      @param eve
      @since 2014-05-18
      */
      editor.mouseup = function(eve) {
        if (editor.pressed) {
          editor.pressed = false;
          var x = eve.pageX + editor.noteeditor_box.scrollLeft;
          var y = eve.pageY + editor.noteeditor_box.scrollTop;
          //remove mouse listeners here?
          if ((x+160) > editor.noteeditor.offsetWidth) {
            editor.noteeditor.style.width = (x+170) + 'px';
          }
          if ((y+110) > editor.noteeditor.offsetHeight) {
            editor.noteeditor.style.height = (y+120) + 'px';
          }
        }
      };
      /**
      @method mouseout
      @param eve
      @since 2014-05-18
      */
      editor.mouseout = function(eve) {
        if (editor.pressed) {
          editor.pressed = false;
          //remove mouse listeners here?
        }
      };
      /**
      shows the help
      @method help
      @since 2014-05-28
      */
      editor.help = function() {
        var help = getElement('help');
        if (help.style.display != 'block') {
          help.style.display = 'block';
        } else {
          help.style.display = 'none';
        }
      };
      /***/
      _win.createElement = function(_ele) {
        return document.createElement(_ele);
      };
      /***/
      _win.createTextNode = function(_txt) {
        return document.createTextNode(_txt);
      };
      /***/
      _win.getElement = function(_id) {
        return document.getElementById(_id);
      };
      /***/
      _win.editor = editor;
      _win.onload = function() { setTimeout(editor.init, 100); };
    }

  )(window);

 </script>
 <style type="text/css">
body {margin: 0; padding: 0; background: #eee; font-family: sans-serif;}
div, span, input, textarea, button, br {font-family: sans-serif; font-size: 13px; margin: 0;}
#editor {position: absolute; top: 0; left: 0; margin: 0; padding: 0;}
#editorbar {position: absolute; top: 0; left: 0; width: 100%; min-height: 25px; height: auto; max-height: 10%;}
#texteditor { position: absolute; top: 10%; left: 0; width: 80%; min-height: 89%; height: 89%; max-height: 89%; background: #eee; border: solid 1px #ddd; resize: none;}
#notelist {position: absolute; top: 10%; left: 80%; width: 20%; min-height: 89%; height: 89%; max-height: 89%; background: #eee; border-top: solid 1px #ddd; overflow: scroll; font-size: 13px;}
#noteeditor {position: relative; width: 100%; min-height: 100%; overflow: hidden; }
#noteeditor_box {position: absolute; top: 10%; left: 0; width: 100%; height: 89%; display: block; background: #eee; resize: none; overflow: hidden; border-bottom: 1px solid #ddd; border-top: 1px solid #ddd; overflow: auto;}
.notelistBox {border: 1px solid #ddd; margin: 2px; background: #ddd; width: 95%;}
#note_input_box {z-index: 20; position: absolute; top: 5px; left: 5px; background: #ddd; padding: 0; box-shadow: -1px -1px 2px rgba(100,100,100,0.5), -1px 1px 2px rgba(100,100,100,0.5), 1px -1px 2px rgba(100,100,100,0.5), 3px 3px 6px rgba(100,100,100,0.5); height: 170px; font-family: sans-serif; font-size: 13px;}
#input_note_title { width: 250px; margin: 0;}
#input_note_text { width: 250px; min-height: 100px; margin: 0;}
#note_input_box span{float: left; width: 50px; margin: 0;}
.closeBoxButton {position: absolute; color: white; background: #c00; top: -1px; right: 1px; width: 24px; max-width: 24px; min-width: 24px; font-size: 10px; font-weight: bold; padding: 0;}
.note{z-index: 10; position: absolute; top: 5px; left: 5px; width: 150px; min-height: 100px; height: auto; background: #ddd; box-shadow: -1px -1px 2px rgba(100,100,100,0.5), -1px 1px 2px rgba(100,100,100,0.5), 1px -1px 2px rgba(100,100,100,0.5), 3px 3px 6px rgba(100,100,100,0.5); overflow: hidden;}
.note_overlay {position: absolute; top: 0px; left: 0px; width: 150px; min-height: 130px; height: auto; background: transparent; /*rgba(0,255,0,0.005)*/}
.note_menu_button {position: absolute; top: 0px; right: 1px; color: white; font-weight: bold; font-size: 25px; }
.eximport {z-index: 30; position: absolute; top: 55px; left: 55px; background: #ddd; box-shadow: -1px -1px 2px rgba(100,100,100,0.5), -1px 1px 2px rgba(100,100,100,0.5), 1px -1px 2px rgba(100,100,100,0.5), 3px 3px 6px rgba(100,100,100,0.5); font-size: 13px; padding: 20px;}
.connectionBox {z-index: 20; position: absolute; top: 5px; left: 5px; background: #ddd; box-shadow: -1px -1px 2px rgba(100,100,100,0.5), -1px 1px 2px rgba(100,100,100,0.5), 1px -1px 2px rgba(100,100,100,0.5), 3px 3px 6px rgba(100,100,100,0.5); font-size: 13px;}
.note_bar {margin: 1px; background: #009; width: 148px; height: 15px; color: white;}
.note_uid {position: absolute; top: 2px; left: 2px; font-size: 12px; font-family: sans-serif;}
.note_title {width: 145px; height: 15px; padding: 2px; border: 0; background: transparent}
.note_text {width: 145px; height: 60px; padding: 2px; border: 0; background: transparent; resize: none;}
.connection{width: 150px; background: #ddd; font-size: 13px; font-family: sans-serif;}
.note_menu{position: absolute; right: 0px; top: 0px; width: auto; max-width: 150px; display: none; text-align: right; border: 1px #999 solid; background: #ddd; margin: 0; box-shadow: -1px -1px 3px #999, 1px -1px 3px #999, -1px 1px 3px #999, 3px 3px 5px #999;}
.note_menu_button:hover .note_menu{display: block;}
.menu_element{font-weight: bold; color: #333; font-size: 13px; font-family: sans-serif; white-space: pre;}
.menu_element:hover {font-weight: bold; color: #fff; font-size: 13px; font-family: sans-serif; background: #009; }
.addConnectionBox {position: absolute; top: 0; left: 0; display: none;}
.arrow {z-index: 1;}
.con_start {position: absolute; right: 0; background: #0b0; color: white; font-weight: bold; padding: 0 5px 0 5px;}
#help {z-index: 100; position: absolute; top: 5px; left: 5px; width: 370px; max-width: 370px; max-height: 98%; border: 1px solid #ddd; background: #eee; box-shadow: -1px -1px 3px #999, -1px 1px 3px #999, 1px -1px 3px #999, 3px 3px 10px #999; display: none; padding: 10px; overflow: auto;}
#help h1 {background: #009; color: #fff; margin: 10px 0 5px 0; padding: 2px 5px 3px 5px; font-size: 15px;}
#help h2 {color: #33c; margin: 0 0 5px 0; font-size: 14px;}
#help div div {display: none;}
#help div:hover div {display: block;}
 </style>
 </head>
 <body>
 <div id="editor">
  <div id="editorbar">
  <button onclick="editor.saveCodeAndGame();" style="float: left;">save code and game</button>
  <button onclick="editor.loadCodeAndGame();" style="float: left;">load code and game</button>
  <button onclick="editor.testGame();" style="float: left;">test game</button>
  <button onclick="editor.stopTest();" style="float: left;">stop test</button>
  <button onclick="editor.toggleEditor();" style="float: left;">toggle</button>
  <button onclick="editor.addNote();" style="float: left;">add note</button>
  <button onclick="editor.importEditor();" style="float: left;">import</button>
  <button onclick="editor.exportEditor();" style="float: left;">export</button>
  <button onclick="editor.buildGame();" style="float: left;">build</button>
  <button onclick="editor.help();" style="float: left;">help</button>
  <br style="clear: both;">
  </div>
  <textarea id="texteditor"><!--var game_cvs = createElement('canvas');
game_cvs.style.width = '450px';
game_cvs.style.height = '300px';
game_cvs.style.background = '#000';
game_cvs.style.position = 'absolute';
game_cvs.style.top = '50px';
game_cvs.style.left = '0px';
document.body.appendChild(game_cvs);
--></textarea>
  <div id="notelist"></div>
  <div id="noteeditor_box">
   <div id="noteeditor">
      <!--div id="note_" class="note">
      <div id="note_bar" class="note_bar"><span id="note_uid" class="note_uid">n0UID</span></div>
      <input type="text" id="note_title" class="note_title" placeholder="note title" /><textarea id="note_text" class="note_text" placeholder="note text"></textarea>
      </div-->

     <!---->
      <!--div id="addConnectionBox" style="position: absolute; top: 0; left: 0; display: none;">from:<span id="boxFrom"></span><br>text:<input id="boxText" name="boxtext" type="text" placeholder="edit message here"/>
      <select id="boxTo" name="boxTo"></select><button id="addConnectionBoxButton"
      onclick="editor.closeAddConnectionBox(this.getAttribute('data-from-id'));">done</button>
      </div-->
     <!---->
   </div>
  </div>
 </div>
<div id="help">
<div style="margin-top: 20px;">
 <h1>What is the 'Drafter' good for?</h1>
  <div>
 <h2>'Drafter' is a 'Twine' like story editor</h2>
 With 'Drafter' you can create interactive story games.<br>
 Interactive story games are text based (mini?) adventures.<br>
 Also you may use this tool for game prototyping.<br>
 'Drafter' is HTML5 and javascript based. <br>
 Because of this 'Drafter' is fully progammable.<br>
 You can edit and program the editor and the game-engine.<br>
  </div>
</div><div>
<h1>How to use the editor</h1>
  <div>
 <h2>'Drafter' is a two ways editor</h2>
 The first view is the note editor.<br>
 With the 'add note' button you insert a new note to the game.<br>
 <br>
 If you want to use the script editor,<br>
 use the 'toggle' button.<br>
  </div>
</div><div>
<h1>Where to start?</h1>
  <div>
 <h2>First you should create a mini story.</h2>
    <br>
    <br>
    <br>
    <br>
    <br>
  </div>
</div><div>
<h1>The tutorial example.</h1>
  <div>
 <h2>Now let's start and write a super simple mini story.</h2>
  This story should have a start, an end and some credits.<br>
  It will look like this in the note editor:<br>
    <img src="img/Screenshot note.png" width="370" style="width: 370px;"/><br>
    <br>
  The script editor will show this:<br>
    <img src="img/Screenshot script.png" width="370" style="width: 370px;"/><br>
    <br>
  And that's how a test run looks like:<br>
    <img src="img/Screenshot game.png" width="370" style="width: 370px;"/><br>
    <br>
  </div>
</div><div>
 <h1>the note editor</h1>
 <div>
 <h2>With the 'add note' button you insert a new note to the game.</h2>
 A note has a title, a text, connections and a unique id.<br>
 All value are empty after creation, except the uid.<br>
 To edit the note, open the note's menu - the * in the upper<br>
 right corner). Choose the option 'edit note'.<br>
 The note box opens in the upper left corner.<br>
 </div>
</div><div>
 <h1>the script editor</h1>
 <div>
 <h2>Here you can change the code of the game engine.</h2>
 You need some basic knowledge of javascript programming.<br>
 Good resources for javascript are:<br>
 <a href="https://stackoverflow.com/questions/tagged/javascript" target="_blank">stackoverflow</a> - for mostly any kind of questions in programming.<br>
 <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference" target="_blank">mozilla</a> javascript reference.<br>
 <a href="http://www.html5rocks.com/" target="_blank">html5rocks</a> - good tutorials for HTML5, CSS and javascript.<br>
 <a href="http://www.w3schools.com/js/DEFAULT.asp">w3schools</a> - JavaScript Tutorial, try it yourself examples in every chapter.<br>
 Tip: search engines are your friend.<br>
 </div>
</div><div>
<h1>What is a note?</h1>
  <div>
 <h2>A note is single text.</h2>
 It is like a tweet in twitter.<br>
 But it has connections (links) to other notes.<br>
 A note has a title, a text and connections. <br> 
 A  note is named 'Passage' in 'twine' - a connection, too.<br>
  </div>
</div><div>
 <h1>toggle button</h1>
  <div>
 <h2>Toggle between the two editor modes</h2>
 source script editor to do the programming,<br>
 note editor for the game creation.<br>
  </div>
</div><div>
 <h1>add note button</h1>
  <div>
 <h2>creates a new note</h2>
 creates a new note, <br>
 adds it to the editor.game.notes array,<br>
 shows it on the noteeditor screen <br>
 and the note ist on the right of the script editor<br>
  </div>
  </div><div>
<h1>Choice between save/load and ex-&import</h1>
  <div>
 <h2>What should you use?</h2>
 save and load are storing in the browser.<br>
 These options use the localStorage or the indexedDB.<br>
 <br>
 With ex- and import you store the game-data to the<br>
 computer's files system. Or you import some data from there.<br>
 <br>
 If you want to pubilish you game, use the 'build'-button.<br>
  </div>
  </div><div>
<h1>The build button</h1>
  <div>
 <h2>Building the final bersion of your game.</h2>
 <br>
 <br>
 <br>
 <br>
 <br>
  </div>
<!--end-->
<button onclick="getElement('help').style.display = 'none';" class="closeBoxButton" style="top: 1px;">X</button>
</div>

 </body>
</html>
